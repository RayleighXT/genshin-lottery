<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>è¿åŠ¿æµ‹è¯•å™¨</title>
    <style>
        body { font-family: Arial; max-width: 600px; margin: 50px auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 10px; }
        .question h2 { color: #333; }
        .options label { display: block; margin: 15px 0; padding: 10px; background: #f9f9f9; border-radius: 5px; cursor: pointer; }
        .options input { margin-right: 10px; }
        .submit-btn { 
            background: #4CAF50; color: white; padding: 12px 30px; 
            border: none; border-radius: 5px; font-size: 16px; 
            cursor: pointer; margin-top: 20px; width: 100%;
        }
        .result { 
            display: none; margin-top: 30px; padding: 20px; 
            background: #e8f5e9; border-radius: 10px; text-align: center;
        }
        .luck-score { font-size: 48px; color: #D4A574; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ² æŠ½å¡è¿åŠ¿æµ‹è¯•å™¨</h1>
        
        <form id="testForm">
            <div class="question">
                <h2>ä»Šå¤©æ˜¯æ˜ŸæœŸå‡ ï¼Ÿ</h2>
                <div class="options">
                    <label><input type="radio" name="weekday" value="0">æ˜ŸæœŸæ—¥</label>
                    <label><input type="radio" name="weekday" value="1">æ˜ŸæœŸä¸€</label>
                    <label><input type="radio" name="weekday" value="2">æ˜ŸæœŸäºŒ</label>
                    <label><input type="radio" name="weekday" value="3">æ˜ŸæœŸä¸‰</label>
                    <label><input type="radio" name="weekday" value="4">æ˜ŸæœŸå››</label>
                    <label><input type="radio" name="weekday" value="5">æ˜ŸæœŸäº”</label>
                    <label><input type="radio" name="weekday" value="6">æ˜ŸæœŸå…­</label>
                </div>
            </div>
            
            <button type="submit" class="submit-btn">ç”Ÿæˆè¿åŠ¿æŠ¥å‘Š</button>
        </form>

        <div id="result" class="result">
            <h2>âœ¨ ä½ çš„æŠ½å¡è¿åŠ¿</h2>
            <div class="luck-score" id="luckScore"></div>
            <p id="luckText"></p>
            <p style="color:#999; font-size:14px;">
                æ•°æ®å·²æ”¶é›† Â· <span id="status"></span>
            </p>
        </div>
    </div>

    <script>
        // é‡‘æ•°æ®æ”¶é›†å™¨åœ°å€ï¼ˆæ›¿æ¢ä½ çš„ï¼‰
        const JINSHUJU_URL = 'https://5rrhdr8j.jsjform.com/f/fj9wGf';

        // è¡¨å•æäº¤äº‹ä»¶
        document.getElementById('testForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // 1. è·å–ç”¨æˆ·é€‰æ‹©çš„å€¼
            const weekday = document.querySelector('input[name="weekday"]:checked');
            if (!weekday) {
                alert('è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼');
                return;
            }

            const value = parseInt(weekday.value);
            
            // 2. è®¡ç®—è¿åŠ¿ = weekday * 21 % 100
            const luck = (value * 21) % 100;
            
            // 3. æ˜¾ç¤ºç»“æœ
            showResult(luck, value);
            
            // 4. å¼‚æ­¥æäº¤åˆ°é‡‘æ•°æ®ï¼ˆä¸å½±å“ç”¨æˆ·ä½“éªŒï¼‰
            submitToJinshuju(value, luck);
        });

        // æ˜¾ç¤ºè¿åŠ¿ç»“æœ
        function showResult(luck, weekday) {
            document.getElementById('luckScore').textContent = luck + '%';
            
            let text = '';
            if (luck > 70) text = 'ğŸŒŸ å¤§å‰ï¼ä»Šå¤©é€‚åˆæŠ½å¡';
            else if (luck > 40) text = 'âœ¨ ä¸­å‰ï¼Œå¯ä»¥è¯•ä¸€è¯•';
            else text = 'ğŸ’€ å°å‡¶ï¼Œå»ºè®®æ”’åŸçŸ³';
            
            document.getElementById('luckText').textContent = text;
            document.getElementById('result').style.display = 'block';
            
            // æ»šåŠ¨åˆ°ç»“æœ
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }

        // æäº¤æ•°æ®åˆ°é‡‘æ•°æ®ï¼ˆFetchç‰ˆæœ¬ï¼‰
        async function submitToJinshuju(data, luckScore) {
            try {
                // ä½ çš„é‡‘æ•°æ®åœ°å€ï¼ˆå·²é…ç½®ï¼‰
                const JINSHUJU_URL = 'https://5rrhdr8j.jsjform.com/f/fj9wGf';
                
                // æ„é€ æäº¤å‚æ•°
                const params = new URLSearchParams({
                    'weekday': data.weekday,
                    'luck_score': luckScore.toFixed(1),
                    'timestamp': Date.now()
                });
                
                const submitUrl = `${JINSHUJU_URL}?${params.toString()}`;
                
                // ä½¿ç”¨ fetch æäº¤ï¼ˆæ›´å¯é ï¼‰
                const response = await fetch(submitUrl, {
                    method: 'GET',
                    mode: 'no-cors', // å…³é”®ï¼šç»•è¿‡è·¨åŸŸé™åˆ¶
                    cache: 'no-cache'
                });
                
                // æ›´æ–°çŠ¶æ€
                document.getElementById('status').innerHTML = 'âœ… æ”¶é›†æˆåŠŸ';
                document.getElementById('status').style.color = '#4CAF50';
                console.log('æ•°æ®æ”¶é›†æˆåŠŸ:', submitUrl);
                
            } catch (error) {
                console.error('æ”¶é›†å¤±è´¥:', error);
                document.getElementById('status').innerHTML = 'âš ï¸ æ”¶é›†å¤±è´¥';
            }
        }
    </script>
</body>
</html>
